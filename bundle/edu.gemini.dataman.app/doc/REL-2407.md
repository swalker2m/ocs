## 2016A Data Manager Updates

Starting with the 2016A semester, Gemini will stop using the Gemini Science Archive provided by CADC and instead switch
to an in-house archive and FITS storage service.  This change will necessitate a number of corresponding updates to the
OCS Data Manager application and provide an opportunity to simplify the OCS codebase and incorporate all FITS processing
services into a single application.  The purpose of this document is to catalog existing Data Manager functionality and
take note of how, in each case, either the same functionality will be provided in the new system or else made obsolete.

In the sections that follow, Data Manager features are introduced in roughly the same order as they are needed in the
lifespan of a dataset.

### Raw Dataset Copy

#### Today

* The Data Manager polls the DHS directory looking for the appearance of new datasets.

  * It ignores all changes to datasets other than the arrival of new datasets.

  * It polls at a 2 minute frequency checking for any new datasets.

  * It polls at a 5 second frequency looking specifically for datasets that it expects will arrive soon.

* When it finds a new dataset, it is copied to the "dataflow" directory, which is available in a separate part of the netapps summit storage facility.

* The "dataflow" copy is updated with the `RELEASE` date header indicating when the dataset becomes public domain according to the following rules (program type - proprietary period):

  * C, DT, LP, Q - 18 months

  * FT - 6 months

  * SV - 3 months

  * CAL, ENG, any other program type - 0 months

* If the program has been marked with a special "private header" flag, a FITS header `PROP_MD` is added with a `true` value.


#### 2016A

All these features are taken care of by the FITS storage service.

__TODO__: today only C, DT, LP, Q, FT, SV, and CAL datasets are sent to the archive.  ENG and others are not sent. Since
the Data Manager won't be looking at the files, all datasets must be archived or the OT will not know they exist.


### File Synchronization

#### Today

* The Data Manger polls the "dataflow" directory looking for new datasets and updates to existing datasets.

  * It polls at a 2 minute frequency checking for any new datasets.

  * It polls at a 5 second frequency looking specifically for datasets that it expects will arrive soon.

*  When it finds a new or updated dataset it either creates (if new) or makes any necessary changes to (if updated) the corresponding dataset record in the ODB.
